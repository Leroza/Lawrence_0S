<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leroza.dev - Retro OS Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Retro Terminal Font -->
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <!-- Font Awesome for Social Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <style>
        /* Define Custom Colors for Theme */
        :root {
            --color-khaki: #C3B091; /* Aged Amber/Terminal Main Color */
            --color-maroon: #500000; /* Deep Background Accent */
            --color-black: #000000;
            --color-white: #FFFFFF;
            --color-orange: #ff8c00; /* Action/Highlight Color */
            --color-danger: #ff0000;
            --color-safe: #00ff00;
        }

        /*
         * 1. Global Reset & Scroll Snap Setup (Retro Font Applied)
         */
        body {
            cursor: none; /* Hide default cursor */
            font-family: 'VT323', monospace;
            background-color: var(--color-black); 
            color: var(--color-khaki); 
            height: 100vh;
            /* Use smooth scrolling for navigation links */
            scroll-behavior: smooth; 
            /* Scroll snap is kept for a screen-by-screen feel */
            scroll-snap-type: y mandatory;
            padding-bottom: 70px; 
            position: relative;
            overflow-x: hidden;
        }

        section {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            scroll-snap-align: start;
            /* Default Adaptive padding */
            padding: 4rem 1rem; 
            text-shadow: 0 0 4px var(--color-khaki), 0 0 8px rgba(195, 176, 145, 0.4); 
        }
        
        /* ----------------------------------------------------
         * CRT OVERLAY & GLITCH EFFECTS
         * ---------------------------------------------------- */
        #crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 10000; opacity: 0.85; 
            box-shadow: inset 0 0 100px rgba(0,0,0,0.7), 0 0 10px rgba(0, 0, 0, 0.8);
            background: repeating-linear-gradient(0deg, rgba(0, 0, 0, 0.15), rgba(0, 0, 0, 0.25) 1px, transparent 1px, transparent 2px); 
            filter: blur(0.2px) contrast(1.1); 
            transform: perspective(1000px) rotateX(0deg) rotateY(0deg); 
        }

        /* Glitch Keyframes */
        @keyframes glitchFlicker {
            0%, 70% { text-shadow: 0 0 5px var(--color-maroon), 0 0 10px rgba(80, 0, 0, 0.4); transform: translate(0, 0); }
            75% { text-shadow: 2px 0px 5px var(--color-danger), -2px 0px 5px rgb(0, 255, 255); transform: translate(1px, 0.5px); }
            80% { text-shadow: -1px 1px 5px rgb(255, 0, 255), 1px -1px 5px var(--color-safe); transform: translate(-1.5px, -1px); }
            85% { text-shadow: 1px -1px 5px var(--color-orange), -1px 1px 5px var(--color-white); transform: translate(0.5px, 0.5px); }
            90%, 100% { text-shadow: 0 0 5px var(--color-maroon), 0 0 10px rgba(80, 0, 0, 0.4); transform: translate(0, 0); }
        }
        .constant-glitch { animation: glitchFlicker 1.2s infinite steps(1); }

        /* ----------------------------------------------------
         * TYPOGRAPHY / FULLSCREEN HERO (Matching Inspiration)
         * ---------------------------------------------------- */
        
        /* New specific style for the hero section to minimize padding and stretch content */
        #intro {
            padding: 1rem; /* Minimal padding on all sides */
            align-items: stretch; /* Stretch content vertically to fill the space */
        }
        
        .split-hero-container {
            display: flex;
            flex-direction: column; /* Stacked on mobile */
            justify-content: space-between;
            align-items: flex-start;
            width: 100%;
            height: 100%;
        }
        @media (min-width: 1024px) {
            .split-hero-container {
                display: grid;
                grid-template-columns: 1fr 1fr; /* Two columns on large screens */
                grid-template-rows: auto 1fr auto;
                gap: 0;
            }
        }
        .hero-massive-text {
            /* Pushed to 25vw for max mobile impact */
            font-size: 25vw; 
            line-height: 0.8; 
            word-break: break-word; 
            max-width: 100%; /* Ensure it can fill the container */
        }
        @media (min-width: 768px) {
            .hero-massive-text { 
                /* Pushed to 18vw for maximum desktop impact */
                font-size: 18vw; 
            }
        }
        
        /* General H2 Title for other sections */
        .max-type-title {
            font-size: 10vw; line-height: 0.9; margin-bottom: 2rem;
        }
        @media (min-width: 768px) {
            .max-type-title { font-size: 6rem; }
        }
        /* General Subtitle for other sections */
        .max-type-subtitle {
            font-size: 3rem; line-height: 1.1; margin-top: 3rem; 
        }
        @media (min-width: 768px) {
             .max-type-subtitle { font-size: 4rem; }
        }
        .max-type-skill-label {
            font-size: 1.5rem; 
        }
        @media (min-width: 768px) {
            .max-type-skill-label { font-size: 2.5rem; }
        }

        /* ----------------------------------------------------
         * UPDATED HUD STYLING (Glass Morphism)
         * ---------------------------------------------------- */
        .hud-bar {
            /* Glass Morphism Effect */
            background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); /* Soft shadow */
            backdrop-filter: blur(8px); /* The main blur effect */
            -webkit-backdrop-filter: blur(8px);
            
            /* Reduced/Softened Borders */
            border-top: 1px solid rgba(195, 176, 145, 0.3); 
            border-bottom: 1px solid rgba(195, 176, 145, 0.3);
            color: var(--color-khaki); 
        }

        /*
         * 2. The Pixel Plane Cursor & Project Log Smoothness
         */
        #plane-cursor {
            position: fixed;
            width: 32px; height: 32px; pointer-events: none; z-index: 10001;
            top: 0; left: 0; transform: translate(-50%, -50%);
            transition: transform 0.05s linear;
        }
        .plane-body {
            position: absolute; top: 50%; left: 50%; width: 2px; height: 2px;
            background-color: var(--color-khaki); transform: translate(-50%, -50%);
            box-shadow: /* Pixel art structure for the plane */
                0 -8px var(--color-khaki), 0 -4px var(--color-khaki), 0 4px var(--color-khaki), 0 8px var(--color-khaki),
                -4px 0 var(--color-khaki), 4px 0 var(--color-khaki), -8px 0 var(--color-khaki), 8px 0 var(--color-khaki),
                -12px 4px var(--color-khaki), 12px 4px var(--color-khaki), -8px 4px var(--color-khaki), 8px 4px var(--color-khaki), -4px 4px var(--color-khaki), 4px 4px var(--color-khaki),
                0 -12px var(--color-khaki), 0 -16px var(--color-orange); 
        }

        /* Project item hover styling adjustments for full width & smoothness */
        .folder-item {
            padding: 1rem 2rem; 
            /* Enhanced transition for smoothness across properties */
            transition: background-color 0.15s ease-out, color 0.15s ease-out, text-shadow 0.15s ease-out;
        }

        .folder-item:hover {
            background-color: rgba(80, 0, 0, 0.6); 
            color: var(--color-white); 
            text-shadow: 0 0 5px var(--color-white);
        }

        /* HUD / Taskbar Responsiveness */
        #hud-bar nav {
            /* Ensures proper centering on mobile */
            flex-direction: column;
            gap: 0.5rem;
        }
        @media (min-width: 768px) {
            #hud-bar nav {
                flex-direction: row;
                gap: 0;
            }
        }

        /* Dynamic Elements */
        .bullet {
            position: fixed; width: 8px; height: 8px;
            background-color: var(--color-orange); 
            border-radius: 50%; z-index: 9999;
            box-shadow: 0 0 10px var(--color-orange), 0 0 30px var(--color-orange); 
            pointer-events: none;
        }
        .destroyed {
            opacity: 0 !important;
            transform: scale(0.5) translateY(-20px);
            transition: opacity 0.3s, transform 0.3s;
        }
        .small-social-icon {
            font-size: 1.5rem; /* Smaller icons for this specific area */
            color: var(--color-khaki);
            transition: color 0.2s, text-shadow 0.2s;
        }
        .small-social-icon:hover {
            color: var(--color-orange);
            text-shadow: 0 0 8px var(--color-orange);
        }
    </style>
</head>
<body>

    <!-- CRT Overlay for Scanlines and Curvature Effect -->
    <div id="crt-overlay" aria-hidden="true"></div>

    <!-- The Custom Plane Cursor -->
    <div id="plane-cursor" aria-hidden="true">
        <div class="plane-body"></div>
    </div>

    <!-- Bullet Container & Effects -->
    <div id="bullet-container"></div>
    <div id="explosion-flash"></div>
    <div id="victory-glitch"></div>
    <div id="project-preview" class="fixed top-0 left-0 hidden z-20 pointer-events-none opacity-0">
        <div id="preview-box" class="p-2 border-4 border-[var(--color-orange)] bg-[var(--color-black)] text-[var(--color-khaki)] shadow-lg" style="width: 400px;">
            <p class="text-xl mb-2 text-center border-b border-[var(--color-khaki)]">FILE\_PREVIEW.IMG</p>
            <img id="preview-image" src="" alt="Project Preview Placeholder" class="w-full h-auto" onerror="this.onerror=null;this.src='https://placehold.co/400x250/ff0000/ffffff?text=ERROR'; document.getElementById('preview-box').style.width='400px'">
        </div>
    </div>

    <!-- HUD / TASKBAR (Fixed to the BOTTOM) -->
    <header id="hud-bar" class="fixed bottom-0 left-0 right-0 z-50 p-3 hud-bar">
        <!-- Flex direction is column on mobile, row on desktop -->
        <nav class="flex justify-between items-center max-w-7xl mx-auto w-full text-lg">
            
            <!-- Group 1 (Left: Skills/Toggles HUD) -->
            <div class="flex items-center space-x-4 md:space-x-6 mx-auto md:mx-0 order-2 md:order-1">
                
                <!-- Targets/HP removed -->

                <!-- Skills/Toggles HUD -->
                <div id="skills-hud" class="hidden sm:flex space-x-2 text-sm font-bold">
                    <span id="skill-1" class="skill-button cursor-pointer on px-2 py-1">[1] SPREAD: OFF</span>
                    <span id="skill-2" class="skill-button cursor-pointer px-2 py-1">[2] REPAIR (5%)</span>
                    <span id="skill-3" class="skill-button cursor-pointer on px-2 py-1">[3] GUN: ACTIVE</span>
                </div>
            </div>

            <!-- Group 2 (Right: Navigation Links) - Text color updated to khaki for visibility -->
            <div class="flex space-x-4 md:space-x-6 text-base font-bold overflow-x-auto p-1 order-1 md:order-2">
                <a href="#intro" class="text-[var(--color-khaki)] hover:text-[var(--color-orange)] transition duration-200 whitespace-nowrap">[ HOME ]</a>
                <a href="#about" class="text-[var(--color-khaki)] hover:text-[var(--color-orange)] transition duration-200 whitespace-nowrap">[ ABOUT ]</a>
                <a href="#skills" class="text-[var(--color-khaki)] hover:text-[var(--color-orange)] transition duration-200 whitespace-nowrap">[ SKILLS ]</a>
                <a href="#projects" class="text-[var(--color-khaki)] hover:text-[var(--color-orange)] transition duration-200 whitespace-nowrap">[ PROJECTS ]</a>
                <a href="#contact" class="text-[var(--color-khaki)] hover:text-[var(--color-orange)] transition duration-200 whitespace-nowrap">[ CONNECT ]</a>
            </div>
        </nav>
    </header>

    <!-- SECTION 1: HOME (Maroon Background) - FULLSCREEN TYPOGRAPHY (Inspired by Design) -->
    <section id="intro" class="bg-[var(--color-maroon)] items-start">
        <!-- New layout uses a grid/flex structure to replicate the massive split text -->
        <div class="split-hero-container w-full h-full max-w-full lg:max-w-7xl mx-auto px-4 sm:px-8">
            
            <!-- Left/Top Block: LEROZA.DEV -->
            <div class="flex flex-col mb-8 lg:mb-0 lg:order-1 lg:col-span-1">
                <!-- Social Links and Speciality Text -->
                <div class="flex items-center space-x-4 mb-4">
                    <p class="text-base md:text-xl text-[var(--color-khaki)] font-light">// FRONT-END // SPECIALIST</p>
                    
                    <!-- LinkedIn Link -->
                    <a href="https://linkedin.com/in/leroza" target="_blank" aria-label="LinkedIn" class="small-social-icon">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    
                    <!-- Facebook Link -->
                    <a href="https://facebook.com/leroza" target="_blank" aria-label="Facebook" class="small-social-icon">
                        <i class="fab fa-facebook"></i>
                    </a>
                </div>
                
                <!-- Main Name Block (LEROZA) -->
                <h2 class="hero-massive-text font-extrabold text-[var(--color-khaki)] destructible-text text-left" data-section="intro">
                    LEROZA.<span class="text-[var(--color-orange)]">DES</span>
                </h2>
                
                <div class="mt-4 lg:mt-8">
                    <span class="text-base md:text-xl text-[var(--color-khaki)] border border-[var(--color-khaki)] p-1 inline-block">2024 - PRESENT</span>
                </div>
            </div>
            
            <!-- Right/Bottom Block: INTO OPPORTUNITY. (STATIC) -->
            <!-- On mobile, this stacks below LEROZA.DEV. On desktop, it moves right and bottom. -->
            <div class="flex flex-col items-start lg:items-end lg:order-2 lg:col-span-1 lg:row-span-2 justify-self-end self-end">
                
                <!-- The static "INTO" part -->
                <h2 class="hero-massive-text font-extrabold text-[var(--color-khaki)] text-left lg:text-right" data-section="intro">
                    MAKE
                </h2>
                
                <!-- The now static "OPPORTUNITY." part -->
                <h2 class="hero-massive-text text-[var(--color-orange)] constant-glitch font-extrabold text-left lg:text-right" 
                    data-section="intro" style="transition: none;">
                    CREATE
                </h2>
            </div>
            
            <!-- Game prompt placed at the bottom, full width -->
            <p class="text-base md:text-xl font-light text-[var(--color-white)] mt-12 w-full lg:order-3 lg:col-span-2 lg:mt-0">
            </p>
        </div>
    </section>

    <!-- SECTION 2: ABOUT (Khaki Background) - Clean, stable text -->
    <section id="about" class="bg-[var(--color-khaki)]">
        <div class="text-center w-full max-w-7xl px-4 text-[var(--color-maroon)]">
             <h2 class="max-type-title font-extrabold destructible-text mb-12" data-section="about">
                USER_FILE
            </h2>
            <div class="flex flex-col md:flex-row items-center md:items-start justify-center gap-12">
                
                <!-- Avatar/Image Placeholder -->
                <div class="w-full md:w-1/3 flex justify-center mb-8 md:mb-0">
                     <img src="https://placehold.co/250x250/500000/C3B091?text=AVATAR" 
                          alt="Leroza Avatar" 
                          class="border-8 border-[var(--color-maroon)] shadow-2xl rounded-none w-48 h-48 md:w-64 md:h-64 object-cover" 
                          style="box-shadow: 0 0 30px rgba(80, 0, 0, 0.8);">
                </div>

                <!-- Text Content (Now responsive text) -->
                <div class="w-full md:w-2/3 text-left space-y-8 text-xl md:text-3xl">
                    <p data-section="about">
                        // REPORT\_001: Leroza is a Frontend Combat Specialist dedicated to creating **elegant, high-performance web experiences**. Expertise: translating complex designs into robust, pixel-perfect UIs.
                    </p>
                    <p data-section="about">
                        // REPORT\_002: Focus on modern JavaScript frameworks (React/Next.js) and clean, scalable architecture. Deployment Status: **Active**. Mission Objective: Deliver visually stunning applications.
                    </p>
                    <a href="#contact" class="inline-block px-4 py-2 text-xl font-bold bg-[var(--color-maroon)] text-[var(--color-khaki)] rounded-none border-2 border-[var(--color-maroon)] hover:bg-[var(--color-orange)] hover:text-white transition duration-300 mt-4">
                        [INITIATE\_CONTACT\_PROTOCOL]
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 3: SKILLS (Maroon Background) - Dedicated Matrix -->
    <section id="skills" class="bg-[var(--color-maroon)]">
        <div class="text-center max-w-7xl px-4 text-[var(--color-khaki)]">
            <h2 class="max-type-title font-extrabold mb-12 destructible-text" data-section="skills">
                SKILL_MATRIX
            </h2>
            
            <div class="skill-matrix-section text-left w-full md:w-[900px] p-4 md:p-12 relative mx-auto">
                
                <h3 class="max-type-subtitle font-extrabold text-[var(--color-khaki)] mb-8 border-b-4 border-b-[var(--color-khaki)] pb-2">
                    PROGRAMMING // CAPACITIES
                </h3>
                
                <!-- Responsive Grid: 1 column on mobile, 2 columns on desktop -->
                <div id="skill-list" class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8"> 
                    <!-- Skills populated by JS - These remain targets -->
                </div>

                <p class="max-type-subtitle font-extralight text-[var(--color-khaki)] mt-12 text-lg md:text-2xl">
                    // PERCENTAGES ARE TARGETS. DESTROY ALL TO PROVE MASTERY.
                </p>
            </div>
        </div>
    </section>

    <!-- SECTION 4: PROJECTS (Khaki Background) -->
    <section id="projects" class="bg-[var(--color-khaki)]">
        <div class="text-center w-full px-4 text-[var(--color-maroon)]">
            <h2 class="max-type-title font-extrabold mb-12 destructible-text" data-section="projects">
                PROJECT_LOG
            </h2>
            <!-- Folder List Structure - Stretched across the viewport -->
            <div id="project-folder-list" class="mt-16 text-left w-full max-w-4xl mx-auto space-y-4">
                
                <div class="folder-item destructible-text max-type-skill-label bg-[var(--color-khaki)] text-[var(--color-maroon)] cursor-pointer" data-section="projects" 
                    onmouseover="showPreview(event, 'https://placehold.co/400x250/500000/C3B091?text=REAL-TIME\_MMO\_COMBAT\_UI')"
                    onmouseout="hidePreview()">
                    > [DIR] REAL-TIME\_MMO\_COMBAT\_UI\_SYSTEM (2024)
                </div>
                
                <div class="folder-item destructible-text max-type-skill-label bg-[var(--color-khaki)] text-[var(--color-maroon)] cursor-pointer" data-section="projects" 
                    onmouseover="showPreview(event, 'https://placehold.co/400x250/C3B091/500000?text=FULL\_STACK\_ANALYTICS\_DASHBOARD')"
                    onmouseout="hidePreview()">
                    > [DIR] FULL\_STACK\_ANALYTICS\_DASHBOARD\_PLATFORM (2023)
                </div>
                
                <div class="folder-item destructible-text max-type-skill-label bg-[var(--color-khaki)] text-[var(--color-maroon)] cursor-pointer" data-section="projects" 
                    onmouseover="showPreview(event, 'https://placehold.co/400x250/ff8c00/FFFFFF?text=WEBSOCKETS\_AND\_THREEJS\_3D')"
                    onmouseout="hidePreview()">
                    > [DIR] WEBSOCKETS\_AND\_THREEJS\_3D\_ENVIRONMENT (2022)
                </div>
                
                <div class="folder-item destructible-text max-type-skill-label bg-[var(--color-khaki)] text-[var(--color-maroon)] cursor-pointer" data-section="projects" 
                    onmouseover="showPreview(event, 'https://placehold.co/400x250/00ff00/500000?text=GENERATIVE\_AI\_NATURAL\_LANGUAGE')"
                    onmouseout="hidePreview()">
                    > [FILE] GENERATIVE\_AI\_NATURAL\_LANGUAGE\_ENGINE\_V1.EXE
                </div>
                
            </div>
        </div>
    </section>

    <!-- SECTION 5: CONTACT (Maroon Background) -->
    <section id="contact" class="bg-[var(--color-maroon)]">
        <div class="text-center max-w-7xl px-4 text-[var(--color-khaki)]">
            <h2 class="max-type-title font-extrabold mb-12 destructible-text" data-section="contact">
                SYSTEM_SHUTDOWN
            </h2>
            <p class="max-type-subtitle font-light text-[var(--color-white)] mt-8 text-xl md:text-3xl" data-section="contact">
                LEROZA@DEV.IO // TERMINATION POINT
            </p>

            <!-- Social Icons -->
            <div class="flex justify-center space-x-8 md:space-x-12 mt-12 mb-16">
                <a href="https://github.com/leroza" target="_blank" aria-label="GitHub" class="social-icon">
                    <i class="fab fa-github"></i>
                </a>
                <a href="https://linkedin.com/in/leroza" target="_blank" aria-label="LinkedIn" class="social-icon">
                    <i class="fab fa-linkedin"></i>
                </a>
                <a href="mailto:leroza@dev.io" aria-label="Email" class="social-icon">
                    <i class="fas fa-envelope"></i>
                </a>
                <a href="https://facebook.com/leroza" target="_blank" aria-label="Facebook" class="social-icon">
                    <i class="fab fa-facebook"></i>
                </a>
            </div>

            <div class="mt-16">
                <!-- Contact Button -->
                <a href="mailto:leroza@dev.io" class="inline-block px-8 py-4 text-xl md:text-3xl font-bold bg-[var(--color-khaki)] text-[var(--color-maroon)] rounded-none shadow-2xl border-4 border-white hover:bg-[var(--color-orange)] hover:text-white transition duration-300 transform hover:scale-105">
                    INITIATE_CONTACT
                </a>
            </div>
        </div>
    </section>

    <script>
        // --- Game Setup and Constants ---
        const planeCursor = document.getElementById('plane-cursor');
        const bulletContainer = document.getElementById('bullet-container');
        const explosionFlash = document.getElementById('explosion-flash');
        const skillListElement = document.getElementById('skill-list'); 
        
        // Preview elements
        const projectPreview = document.getElementById('project-preview');
        const previewImage = document.getElementById('preview-image');
        const previewBox = document.getElementById('preview-box');

        // Core Game Constants
        const BULLET_SPEED = 20; 
        const FIRE_RATE = 100; 
        const REPAIR_AMOUNT = 5; 

        // Consolidated Skill Data
        const SKILL_DATA = [
            { name: "HTML/CSS/TAILWIND", percent: 95, color: '#ff8c00' }, 
            { name: "JAVASCRIPT (ES6+)", percent: 95, color: '#00ff00' },
            { name: "REACT/NEXT.JS", percent: 90, color: '#00ff00' },
            { name: "TYPESCRIPT", percent: 85, color: '#00ff00' },
            { name: "NODE/EXPRESS", percent: 80, color: '#ffff00' },
            { name: "FIREBASE/MONGO", percent: 75, color: '#ff0000' },
            { name: "UX/UI DESIGN", percent: 90, color: '#ff8c00' }, 
            { name: "VERSION CONTROL (GIT)", percent: 95, color: '#00ff00' },
        ];

        // --- State Variables ---
        let mouseX = 0;
        let mouseY = 0;
        let lastBulletTime = 0;
        let bullets = [];
        let targets = []; 
        let totalTargets = 0;
        let destroyedTargets = 0;
        let gameOver = false; 
        let hideTimeout;
        let spreadShotActive = false;
        let isFiring = true; 
        
        /**
         * 1. Populates the dedicated skill matrix section with destructible targets.
         */
        function setupSkillsMatrixSection() {
            // Clear existing targets only for the skill list area
            targets = targets.filter(span => !span.closest('#skill-list')); 
            skillListElement.innerHTML = ''; 

            SKILL_DATA.forEach(skill => {
                const skillLine = document.createElement('div');
                // IMPORTANT: Removed 'destructible-text' from here to prevent double processing in initializeTargets()
                skillLine.className = `max-type-skill-label font-light flex flex-col md:flex-row items-start md:items-center justify-between space-y-2 md:space-y-0`;
                skillLine.style.animationDelay = `-${Math.random()}s`;

                // Name (Static White text for high contrast inside the maroon skill box)
                const nameContainer = document.createElement('span');
                nameContainer.className = 'skill-name text-white mr-4'; 
                nameContainer.textContent = `${skill.name}`;
                skillLine.appendChild(nameContainer);

                // Destructible part (Percentage)
                const percentContainer = document.createElement('span');
                percentContainer.className = 'flex';

                const destructibleText = `${skill.percent}%`;
                destructibleText.split('').forEach(char => {
                    const span = document.createElement('span');
                    span.textContent = char === ' ' ? '\u00A0' : char; 
                    span.dataset.destroyed = 'false';
                    span.style.color = skill.color; // Color-coded by strength
                    
                    percentContainer.appendChild(span);
                    
                    if (char !== ' ') {
                        targets.push(span); // Add new targets for the game
                    }
                });

                skillLine.appendChild(percentContainer);
                skillListElement.appendChild(skillLine);
            });
        }


        /**
         * 2. Pre-process text and wrap every letter in a <span> across ALL sections.
         * ONLY TARGETS MAIN HEADERS AND FOLDER ITEMS.
         */
        function initializeTargets() {
            // Keep existing skill targets
            const existingTargets = targets.filter(span => span.closest('#skill-list'));
            targets = existingTargets;

            // Target ONLY elements with the 'destructible-text' class that haven't been processed
            document.querySelectorAll(`.destructible-text`).forEach(element => {
                // Skip if already processed or is the skill list parent
                if (element.children.length > 0 && element.children[0].tagName === 'SPAN') return;
                if (element.id === 'skill-list') return; 

                const textContent = element.textContent.trim();
                element.innerHTML = ''; // Clear original text
                
                textContent.split('').forEach(char => {
                    const span = document.createElement('span');
                    span.textContent = char === ' ' ? '\u00A0' : char; 
                    span.dataset.destroyed = 'false';
                    element.appendChild(span);
                    
                    if (char !== ' ') {
                        // Determine color based on section background
                        const section = element.closest('section');
                        const isKhakiSection = section.id === 'about' || section.id === 'projects';
                        span.style.color = isKhakiSection ? 'var(--color-maroon)' : 'var(--color-khaki)';
                        targets.push(span);
                    }
                });
            });

            // Recalculate total stats
            totalTargets = targets.length;
            destroyedTargets = targets.filter(span => span.dataset.destroyed === 'true').length; 
            updateHealthBar();
        }

        /**
         * 3. Health Bar and Game State Management (Now only checks for optional victory)
         */
        function updateHealthBar() {
            if (totalTargets === 0) return;

            // Check for optional "Game Over" (All targets destroyed)
            if (destroyedTargets >= totalTargets && !gameOver) {
                gameOver = true;
                triggerGlitchEffect();
            }
        }

        // --- PROJECT PREVIEW FUNCTIONS (Hover Hologram) ---
        function showPreview(event, imageUrl) {
            if (gameOver) return;
            clearTimeout(hideTimeout);
            previewImage.src = imageUrl;
            
            const offsetX = 40; 
            const offsetY = 40; 
            
            let newX = mouseX + offsetX;
            let newY = mouseY + offsetY;

            const previewWidth = previewBox.offsetWidth || 416; 
            if (newX + previewWidth > window.innerWidth) { newX = mouseX - previewWidth - offsetX; }
            const previewHeight = previewBox.offsetHeight || 300; 
            if (newY + previewHeight > window.innerHeight) { newY = window.innerHeight - previewHeight - 10; }
            
            projectPreview.style.left = `${newX}px`;
            projectPreview.style.top = `${newY}px`;
            
            projectPreview.classList.remove('hidden');
            setTimeout(() => { projectPreview.style.opacity = '1'; }, 10); 
        }

        function hidePreview() {
            clearTimeout(hideTimeout);
            hideTimeout = setTimeout(() => {
                projectPreview.style.opacity = '0';
                setTimeout(() => {
                    projectPreview.classList.add('hidden');
                }, 200); 
            }, 50);
        }
        
        // --- SKILL IMPLEMENTATIONS (Keys 1, 2, 3) ---

        function toggleSkillButtonVisual(skillId, isActive) {
            const skillEl = document.getElementById(skillId);
            if (!skillEl) return;
            // Handle skill button styling
            if (isActive) {
                skillEl.classList.add('on');
                skillEl.classList.remove('text-[var(--color-maroon)]');
                skillEl.classList.add('text-[var(--color-white)]');
            } else {
                skillEl.classList.remove('on');
                skillEl.classList.add('text-[var(--color-maroon)]');
                skillEl.classList.remove('text-[var(--color-white)]');
            }
        }

        function toggleSpreadShot() {
            spreadShotActive = !spreadShotActive;
            document.getElementById('skill-1').textContent = `[1] SPREAD: ${spreadShotActive ? 'ON' : 'OFF'}`;
            toggleSkillButtonVisual('skill-1', spreadShotActive);
            lastBulletTime = 0; 
        }

        function repairTargets() {
            if (destroyedTargets === 0) return;
            const skillEl = document.getElementById('skill-2');
            skillEl.classList.add('pressed');
            setTimeout(() => {
                skillEl.classList.remove('pressed');
                explosionFlash.classList.remove('do-explosion'); 
            }, 500);

            explosionFlash.classList.add('do-explosion');
            
            const repairCount = Math.ceil(totalTargets * (REPAIR_AMOUNT / 100));
            const destroyedSpans = targets.filter(span => span.dataset.destroyed === 'true').reverse();
            const spansToRepair = destroyedSpans.slice(0, Math.min(repairCount, destroyedSpans.length));
            
            spansToRepair.forEach(span => {
                span.classList.remove('destroyed');
                span.dataset.destroyed = 'false';
                destroyedTargets--; 
                gameOver = false; // Allow re-triggering the victory glitch
            });

            updateHealthBar();
        }

        function toggleGunActive() {
            isFiring = !isFiring;
            document.getElementById('skill-3').textContent = `[3] GUN: ${isFiring ? 'ACTIVE' : 'OFF'}`;
            toggleSkillButtonVisual('skill-3', isFiring); 
        }

        /**
         * 4. Victory Glitch
         */
        function triggerGlitchEffect() {
            const glitchEl = document.getElementById('victory-glitch');
            if (!glitchEl) return;
            glitchEl.classList.add('rainbow-glitch-active');
            setTimeout(() => {
                glitchEl.classList.remove('rainbow-glitch-active');
            }, 5000); 
        }

        /**
         * 6. Cursor Tracking & Bullet Creation/Game Loop
         */
        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
            planeCursor.style.transform = `translate(${mouseX}px, ${mouseY}px)`;
        });
        
        document.addEventListener('keydown', (e) => {
            if (gameOver) return;
            switch (e.key) {
                case '1': toggleSpreadShot(); break;
                case '2': repairTargets(); break;
                case '3': toggleGunActive(); break;
            }
        });
        
        // Add touch event support for basic cursor tracking on mobile
        document.addEventListener('touchmove', (e) => {
             e.preventDefault(); // Prevent scrolling while touching the cursor area
             const touch = e.touches[0];
             mouseX = touch.clientX;
             mouseY = touch.clientY;
             planeCursor.style.transform = `translate(${mouseX}px, ${touch.clientY}px)`;
        });

        document.getElementById('skill-1').addEventListener('click', toggleSpreadShot);
        document.getElementById('skill-2').addEventListener('click', repairTargets);
        document.getElementById('skill-3').addEventListener('click', toggleGunActive);


        function createBullet() {
            if (gameOver || !isFiring) return; 
            
            const angles = spreadShotActive ? [-0.174, 0, 0.174] : [0]; 
            const startX = mouseX - 4; 
            const startY = mouseY - 16; 

            for (let i = 0; i < angles.length; i++) {
                const angle = angles[i];
                const bullet = document.createElement('div');
                bullet.className = 'bullet';
                
                bullet.style.left = `${startX}px`;
                bullet.style.top = `${startY}px`;

                const vx = Math.sin(angle) * BULLET_SPEED; 
                const vy = -Math.cos(angle) * BULLET_SPEED;
                
                const bulletObj = {
                    el: bullet, x: startX, y: startY, vx: vx, vy: vy
                };
                
                bullets.push(bulletObj);
                bulletContainer.appendChild(bullet);
            }
        }

        function gameLoop(currentTime) {
            requestAnimationFrame(gameLoop);

            const currentFireRate = spreadShotActive ? FIRE_RATE * 1.5 : FIRE_RATE;

            if (isFiring && currentTime - lastBulletTime > currentFireRate) {
                createBullet();
                lastBulletTime = currentTime;
            }
            
            bullets = bullets.filter(bullet => {
                bullet.x += bullet.vx;
                bullet.y += bullet.vy;
                bullet.el.style.left = `${bullet.x}px`;
                bullet.el.style.top = `${bullet.y}px`;

                if (bullet.y < 0) {
                    bullet.el.remove();
                    return false; 
                }

                let hit = false;
                for (let i = 0; i < targets.length; i++) {
                    const targetSpan = targets[i];
                    
                    if (targetSpan.dataset.destroyed === 'true') continue;

                    const rect = targetSpan.getBoundingClientRect();
                    const bulletSize = 8;
                    const collision = (
                        bullet.x < rect.right &&
                        bullet.x + bulletSize > rect.left &&
                        bullet.y < rect.bottom &&
                        bullet.y + bulletSize > rect.top
                    );
                    
                    if (collision) {
                        targetSpan.classList.add('destroyed');
                        targetSpan.dataset.destroyed = 'true';
                        
                        // Shatter effect code removed
                        
                        destroyedTargets++;
                        updateHealthBar();
                        
                        bullet.el.remove();
                        hit = true;
                        
                        break; 
                    }
                }
                return !hit; 
            });
        }

        window.onload = () => {
            setupSkillsMatrixSection(); 
            initializeTargets(); // Now runs AFTER skills are added
            
            // Ensure visual state is set correctly at startup
            toggleSkillButtonVisual('skill-1', spreadShotActive);
            toggleSkillButtonVisual('skill-3', isFiring);
            
            requestAnimationFrame(gameLoop);
        };

    </script>
</body>
</html>
